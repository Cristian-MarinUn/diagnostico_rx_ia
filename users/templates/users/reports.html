{% extends 'core/base.html' %}
{% load static %}

{% block title %}Reportes Estad√≠sticos{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'users/css/dashboard.css' %}">
{% endblock %}

{% block content %}
<div class="dashboard-wrapper">
    <div class="dashboard-container">
        <a href="{% url 'users:admin_dashboard' %}" class="btn" style="background: rgba(128,0,255,0.7); color: #fff; border: none; margin-bottom: 20px; padding: 10px 24px; border-radius: 6px; box-shadow: 0 2px 8px rgba(128,0,255,0.12);">
            ‚Üê Volver al Panel de Administraci√≥n
        </a>
        <div class="section-header">
            <h2 class="section-title">
                <span class="section-title-icon">üìä</span>
                <span>Reportes Estad√≠sticos</span>
            </h2>
        </div>
        <form method="get" class="report-type-form">
            <label for="report_type">Tipo de reporte:</label>
            <select name="report_type" id="report_type">
                <option value="precision" {% if report_type == 'precision' %}selected{% endif %}>Precisi√≥n del sistema</option>
                <option value="diagnosticos" {% if report_type == 'diagnosticos' %}selected{% endif %}>Diagn√≥sticos realizados</option>
                <option value="uso" {% if report_type == 'uso' %}selected{% endif %}>Uso de m√≥dulos</option>
            </select>
            <button type="submit" class="btn btn-primary">Generar</button>
        </form>

        {% if no_data %}
            <div class="alert alert-warning" style="margin-top:20px;">
                No existen datos suficientes para generar el reporte.
            </div>
        {% else %}
            <div class="report-content" style="margin-top:20px;">
                {% if report_type == 'precision' %}
                    <h3>Precisi√≥n del sistema</h3>
                    <table class="table">
                        <thead>
                            <tr><th>Fecha</th><th>Precisi√≥n (%)</th></tr>
                        </thead>
                        <tbody>
                            {% for row in report_data %}
                                <tr><td>{{ row.fecha }}</td><td>{{ row.precision }}</td></tr>
                            {% endfor %}
                        </tbody>
                    </table>
                {% elif report_type == 'diagnosticos' %}
                    <h3>Diagn√≥sticos realizados</h3>
                    <table class="table">
                        <thead>
                            <tr><th>Fecha</th><th>Cantidad</th></tr>
                        </thead>
                        <tbody>
                            {% for row in report_data %}
                                <tr><td>{{ row.fecha }}</td><td>{{ row.cantidad }}</td></tr>
                            {% endfor %}
                        </tbody>
                    </table>
                {% elif report_type == 'uso' %}
                    <h3>Uso de m√≥dulos</h3>
                    <table class="table">
                        <thead>
                            <tr><th>M√≥dulo</th><th>Uso</th></tr>
                        </thead>
                        <tbody>
                            {% for row in report_data %}
                                <tr><td>{{ row.modulo }}</td><td>{{ row.uso }}</td></tr>
                            {% endfor %}
                        </tbody>
                    </table>
                {% endif %}
                <form method="post" style="margin-top:20px;">
                    {% csrf_token %}
                    <button type="submit" name="export" value="pdf" class="btn btn-secondary">Exportar a PDF</button>
                    <button type="submit" name="export" value="excel" class="btn btn-secondary">Exportar a Excel</button>
                </form>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}
